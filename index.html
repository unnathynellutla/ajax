<!doctype html>
<html>
<head>
	<title>JSON Demo</title>
	<meta charset="utf-8"/>
	<script>
		function loadMessages() {
			var ajaxRequest = new XMLHttpRequest();
			ajaxRequest.open("GET", "https://ghibliapi.herokuapp.com/films", true);
			
			ajaxRequest.onreadystatechange = function() {
				document.getElementById("messages").innerHTML = "Readystate changed"; 
			
				if(ajaxRequest.readyState == 1){
					document.getElementById("messages").innerHTML = "Connected";
				}
				else if(ajaxRequest.readyState == 2){
				document.getElementById("messages").innerHTML = "Request received by server.";
				}
				else if(ajaxRequest.readyState == 3){
					document.getElementById("messages").innerHTML = "Processing request.";
				}
				else if(ajaxRequest.readyState == 4){
					document.getElementById("messages").innerHTML =  "Done loading! " + ajaxRequest.status;
					if(ajaxRequest.status == 200){
						result = ajaxRequest.responseText;
						films = JSON.parse(result);
						strHTML = "<ul>";
						films.forEach(function(film) { 
					 		strHTML += "<li>" + film.title + " : <br>" + film.description + "<br></li>";
						}) 
						strHTML += "</ul>";
						document.getElementById("messages").innerHTML = strHTML;
					}
				} else {
					document.getElementById("messages").innerHTML =  "Wrong";
				}
			}
			
			ajaxRequest.send();
		};
		
	</script>
</head>


<body onload="loadMessages()">

	<h1>JSON Data</h1>
	<div id="messages">Loading...</div>
</body>
</html>
